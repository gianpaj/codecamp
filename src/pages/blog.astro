---
import { getCollection } from "astro:content";

import Layout from "@layouts/Layout.astro";
import getSortedPosts from "@utils/getSortedPosts";

import { SITE } from "../config";
import Card from "@components/Card.astro";

const posts = await getCollection("blog");
// const featuredPosts = sortedPosts.filter(({ data }) => data.featured);

export async function getStaticPaths() {
  return posts.map((post) => ({
    params: {
      slug: post.slug,
    },
    props: {
      post,
    },
  }));
}
const sortedPosts = getSortedPosts(posts);

const headTitle = `Blog - ${SITE.title}`;
---

<Layout title={headTitle}>
  <main>
    <section
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 py-8"
      data-test="articles-section"
    >
      {
        sortedPosts.map(({ data }) => (
          <div class="col-span-1">
            {/*<Card post={p} />*/}
            <Card frontmatter={data} />
          </div>
        ))
      }
    </section>
  </main>
  <style></style>
</Layout>
